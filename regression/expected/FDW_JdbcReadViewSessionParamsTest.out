-- @description query01 for JDBC query from view
-- start_ignore
-- end_ignore

CREATE SERVER jdbc_test_no_params
    FOREIGN DATA WRAPPER jdbc_pxf_fdw
    OPTIONS ( config 'database' );

CREATE USER MAPPING FOR CURRENT_USER SERVER jdbc_test_no_params;

CREATE SERVER jdbc_test_session_params
    FOREIGN DATA WRAPPER jdbc_pxf_fdw
    OPTIONS ( config 'db-session-params' );

CREATE USER MAPPING FOR CURRENT_USER SERVER jdbc_test_session_params;

DROP FOREIGN TABLE IF EXISTS pxf_jdbc_read_view_no_params CASCADE;
NOTICE:  foreign table "pxf_jdbc_read_view_no_params" does not exist, skipping

CREATE FOREIGN TABLE pxf_jdbc_read_view_no_params
(
    name    text,
    setting text
) SERVER jdbc_test_no_params
    OPTIONS ( resource 'pg_settings' );

SELECT * FROM pxf_jdbc_read_view_no_params WHERE name='client_min_messages' OR name='default_statistics_target' ORDER BY name;
           name            | setting 
---------------------------+---------
 client_min_messages       | notice
 default_statistics_target | 100
(2 rows)

DROP FOREIGN TABLE IF EXISTS pxf_jdbc_read_view_session_params CASCADE;
NOTICE:  foreign table "pxf_jdbc_read_view_session_params" does not exist, skipping

CREATE FOREIGN TABLE pxf_jdbc_read_view_session_params
(
    name    text,
    setting text
) SERVER jdbc_test_session_params
    OPTIONS ( resource 'pg_settings' );

SELECT * FROM pxf_jdbc_read_view_session_params WHERE name='client_min_messages' OR name='default_statistics_target' ORDER BY name;
           name            | setting 
---------------------------+---------
 client_min_messages       | debug1
 default_statistics_target | 123
(2 rows)

-- start_ignore
-- end_ignore